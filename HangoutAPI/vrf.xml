<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<!-- Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *      
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License
-->
        <ModulePrefs title="Hangout Starter">
                <Require feature="rpc" />
                <Require feature="views" />\
                <Require feature="locked-domain" /> \
        </ModulePrefs>
        <Content type="html"><![CDATA[     

<html>
<head>
        <title>Virutal Fitting Room</title>
            <meta http-equiv="Content-Type" content="text/html;
charset = iso - 8859 - 1 " />
</head>


<script src="//plus.google.com/hangouts/_/api/v1/hangout.js"></script>

<script>

function loadOverlay(uri) {
    console.log("loading");
    resource = gapi.hangout.av.effects.createImageResource(
        uri);

    resource.onLoad.add( function(event) {
        if ( !event.isLoaded ) {
            alert("Not loaded");
        }
    });
    overlay = resource.createFaceTrackingOverlay(
        {'trackingFeature': gapi.hangout.av.effects.FaceTrackingFeature.NOSE_ROOT,
         'scaleWithFace': true,
         'rotateWithFace': true,
         'scale': 0.45,
         'scaleWithFace' : true});
    overlay.setOffset(-0.12,-1);
    overlay.setVisible(true);
    console.log('loaded');
}

function init() {
  gapi.hangout.onApiReady.add(function(eventObj) {
    console.log("everything ready");
    var vCanvas = gapi.hangout.layout.getVideoCanvas();
    vCanvas.setPosition(350,10);
    vCanvas.setVisible(true);
    loadOverlay("https://dl.dropboxusercontent.com/u/69037120/site/cap2.png");
  });
}

gadgets.util.registerOnLoadHandler(init);
</script>
</html>
]]>

</Content>

</Module>